<html>
   <head>
      <script src="https://cdn.kustomerapp.com/card-js/latest/kustomer-card.min.js"></script>
      <script>

        function getLastConversation(conversationId){
            const params = {
                url: `/v1/conversations/${conversationId}`,
                method: "GET",
            }
         
            Kustomer.request(params, (err, response) => {
            if (err) {
                console.error(err);
            }
                console.log(response);
            });
        }

         function loadContext() {
             // Kustomer.initialize is required for card visibility in panel.
             Kustomer.initialize(function(contextJSON) {
                 console.log(contextJSON)
                 if(contextJSON?.customer?.attributes?.lastConversation?.id){
                    getLastConversation(contextJSON?.customer?.attributes?.lastConversation?.id)
                 }
             });
             
             
             
         }
         
                 
      </script>
   </head>
   <body onload="loadContext()">
      <div class="ui card mainCard">
         <div class="content">
            <div class="ui header cardHeader">
               Modal content
            </div>
         </div>
         <hr class="lineBreak">
         <br/><br/>
         <div id="container" class="ui one textArea"></div>
         <input type="button" value="Authorize" id="btnAuthorize" />
         <input type="button" value="Unauthorize" id="btnUnAuthorize" />
         <div id="eventLog"></div>
      </div>
   </body>
</html>